<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>MailResponder documentation &#8212; MailResponder 1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=27fed22d" />
    <script src="_static/documentation_options.js?v=f2a433a1"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="mailresponder-documentation">
<h1>MailResponder documentation<a class="headerlink" href="#mailresponder-documentation" title="Link to this heading">¶</a></h1>
<p>Add your content using <code class="docutils literal notranslate"><span class="pre">reStructuredText</span></code> syntax. See the
<a class="reference external" href="https://www.sphinx-doc.org/en/master/usage/restructuredtext/index.html">reStructuredText</a>
documentation for details.</p>
<div class="toctree-wrapper compound">
</div>
<dl class="py function" id="module-main">
<dt class="sig sig-object py" id="main.main">
<span class="sig-prename descclassname"><span class="pre">main.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#main.main" title="Link to this definition">¶</a></dt>
<dd><p>Main function to run the Dean’s Office email handling process.</p>
<p>Workflow:
1. Initialize mailbox client and authorize with Gmail API.
2. Prepare directory for storing email data.
3. Clean previous email files from the directory.
4. Read unread emails from the mailbox.
5. Classify emails using Bayes classifier.
6. Generate AI responses to emails.
7. Iterate over stored email directories matching pattern “Mail&lt;number&gt;”.
8. Send the generated responses via Gmail API.</p>
<p>No parameters or return values.</p>
<p>Side effects:
- Reads and writes files in the “EmailsToRespond” directory.
- Sends emails via Gmail API.</p>
</dd></dl>

<dl class="py class" id="module-database_manager">
<dt class="sig sig-object py" id="database_manager.CombinedMetaClass">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">database_manager.</span></span><span class="sig-name descname"><span class="pre">CombinedMetaClass</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bases</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">namespace</span></span></em>, <em class="sig-param"><span class="positional-only-separator o"><abbr title="Positional-only parameter separator (PEP 570)"><span class="pre">/</span></abbr></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#database_manager.CombinedMetaClass" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABCMeta</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">DeclarativeMeta</span></code></p>
<p>Metaclass combining ABCMeta and DeclarativeMeta to support both abstract base classes
and SQLAlchemy ORM declarative base functionality.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="database_manager.Database">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">database_manager.</span></span><span class="sig-name descname"><span class="pre">Database</span></span><a class="headerlink" href="#database_manager.Database" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for initializing the SQLite database and session.</p>
<dl class="py method">
<dt class="sig sig-object py" id="database_manager.Database.make_db">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">make_db</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#database_manager.Database.make_db" title="Link to this definition">¶</a></dt>
<dd><p>Initialize the SQLite database, create tables, and populate with
default data including office hours, scholarships, and student records.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>SQLAlchemy session instance connected to the database.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="database_manager.DeansOfficeHours">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">database_manager.</span></span><span class="sig-name descname"><span class="pre">DeansOfficeHours</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#database_manager.DeansOfficeHours" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Base</span></code>, <a class="reference internal" href="#database_manager.DeansOfficeTableInterface" title="database_manager.DeansOfficeTableInterface"><code class="xref py py-class docutils literal notranslate"><span class="pre">DeansOfficeTableInterface</span></code></a></p>
<p>SQLAlchemy ORM model representing Dean’s Office working hours.</p>
<dl class="simple">
<dt>Attributes:</dt><dd><p>id (int): Primary key, autoincremented.
weekday (str): Name of the weekday (e.g., ‘Monday’).
opening (datetime.time): Office opening time.
closing (datetime.time): Office closing time.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="database_manager.DeansOfficeHours.closing">
<span class="sig-name descname"><span class="pre">closing</span></span><a class="headerlink" href="#database_manager.DeansOfficeHours.closing" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="database_manager.DeansOfficeHours.fill">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fill</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">current_session</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#database_manager.DeansOfficeHours.fill" title="Link to this definition">¶</a></dt>
<dd><p>Populate the ‘hours’ table with default working hours (8:00 to 15:00)
for weekdays Monday through Friday.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>current_session</strong> – SQLAlchemy session to add records to.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="database_manager.DeansOfficeHours.id">
<span class="sig-name descname"><span class="pre">id</span></span><a class="headerlink" href="#database_manager.DeansOfficeHours.id" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="database_manager.DeansOfficeHours.opening">
<span class="sig-name descname"><span class="pre">opening</span></span><a class="headerlink" href="#database_manager.DeansOfficeHours.opening" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="database_manager.DeansOfficeHours.table_to_dict">
<span class="sig-name descname"><span class="pre">table_to_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#database_manager.DeansOfficeHours.table_to_dict" title="Link to this definition">¶</a></dt>
<dd><p>Convert the instance data to dictionary format.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict with keys “day”, “open_time”, and “close_time”</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="database_manager.DeansOfficeHours.weekday">
<span class="sig-name descname"><span class="pre">weekday</span></span><a class="headerlink" href="#database_manager.DeansOfficeHours.weekday" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="database_manager.DeansOfficeTableInterface">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">database_manager.</span></span><span class="sig-name descname"><span class="pre">DeansOfficeTableInterface</span></span><a class="headerlink" href="#database_manager.DeansOfficeTableInterface" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Abstract interface class for Dean’s Office database tables.</p>
<p>Requires implementing classes to provide a method to convert
table instances to dictionary representation.</p>
<dl class="py method">
<dt class="sig sig-object py" id="database_manager.DeansOfficeTableInterface.table_to_dict">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">table_to_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#database_manager.DeansOfficeTableInterface.table_to_dict" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="database_manager.ScholarshipValue">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">database_manager.</span></span><span class="sig-name descname"><span class="pre">ScholarshipValue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#database_manager.ScholarshipValue" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Base</span></code>, <a class="reference internal" href="#database_manager.DeansOfficeTableInterface" title="database_manager.DeansOfficeTableInterface"><code class="xref py py-class docutils literal notranslate"><span class="pre">DeansOfficeTableInterface</span></code></a></p>
<p>ORM model representing scholarship types and values.</p>
<dl class="simple">
<dt>Attributes:</dt><dd><p>id (int): Primary key, autoincremented.
kind (str): Type of scholarship (e.g., ‘rectors scholarship’).
money (float): Amount of money awarded.
grade_level (float): Minimum grade level required, nullable.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="database_manager.ScholarshipValue.grade_level">
<span class="sig-name descname"><span class="pre">grade_level</span></span><a class="headerlink" href="#database_manager.ScholarshipValue.grade_level" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="database_manager.ScholarshipValue.id">
<span class="sig-name descname"><span class="pre">id</span></span><a class="headerlink" href="#database_manager.ScholarshipValue.id" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="database_manager.ScholarshipValue.kind">
<span class="sig-name descname"><span class="pre">kind</span></span><a class="headerlink" href="#database_manager.ScholarshipValue.kind" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="database_manager.ScholarshipValue.money">
<span class="sig-name descname"><span class="pre">money</span></span><a class="headerlink" href="#database_manager.ScholarshipValue.money" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="database_manager.ScholarshipValue.table_to_dict">
<span class="sig-name descname"><span class="pre">table_to_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#database_manager.ScholarshipValue.table_to_dict" title="Link to this definition">¶</a></dt>
<dd><p>Convert the scholarship instance to dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict with keys “id”, “kind”, “money”, “grade_level”</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="database_manager.StudentList">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">database_manager.</span></span><span class="sig-name descname"><span class="pre">StudentList</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#database_manager.StudentList" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Base</span></code>, <a class="reference internal" href="#database_manager.DeansOfficeTableInterface" title="database_manager.DeansOfficeTableInterface"><code class="xref py py-class docutils literal notranslate"><span class="pre">DeansOfficeTableInterface</span></code></a></p>
<p>ORM model representing a student record.</p>
<dl class="simple">
<dt>Attributes:</dt><dd><p>student_id (str): Primary key student identifier.
name (str): Student’s first name.
surname (str): Student’s surname.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="database_manager.StudentList.name">
<span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#database_manager.StudentList.name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="database_manager.StudentList.student_id">
<span class="sig-name descname"><span class="pre">student_id</span></span><a class="headerlink" href="#database_manager.StudentList.student_id" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="database_manager.StudentList.surname">
<span class="sig-name descname"><span class="pre">surname</span></span><a class="headerlink" href="#database_manager.StudentList.surname" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="database_manager.StudentList.table_to_dict">
<span class="sig-name descname"><span class="pre">table_to_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#database_manager.StudentList.table_to_dict" title="Link to this definition">¶</a></dt>
<dd><p>Convert the student record to dictionary format.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict with keys “student_id”, “name”, “surname”</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class" id="module-get_essential_info_from_text">
<dt class="sig sig-object py" id="get_essential_info_from_text.NameSearcher">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">get_essential_info_from_text.</span></span><span class="sig-name descname"><span class="pre">NameSearcher</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">db_session</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#get_essential_info_from_text.NameSearcher" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class to perform Named Entity Recognition (NER) on text input and
search for matching student names in a mail.</p>
<dl class="simple">
<dt>Attributes:</dt><dd><p>pipe (transformers.Pipeline): A Hugging Face transformers pipeline for token classification (NER).
session (SQLAlchemy.Session): Database session for querying student records.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="get_essential_info_from_text.NameSearcher.text_ner_analizer">
<span class="sig-name descname"><span class="pre">text_ner_analizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">txt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#get_essential_info_from_text.NameSearcher.text_ner_analizer" title="Link to this definition">¶</a></dt>
<dd><p>Analyze input text using NER to extract potential student names and surnames,
and match them against the database records.</p>
<p>The method searches for the first matching name and surname found in the text
that exist in the database, then retrieves the corresponding student record.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>txt</strong> – str, input text to analyze.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dict or None, containing keys ‘name’, ‘surname’, and ‘student_id’ if a matching student is found; otherwise None.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class" id="module-mailbox_manager">
<dt class="sig sig-object py" id="mailbox_manager.ClientMailbox">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mailbox_manager.</span></span><span class="sig-name descname"><span class="pre">ClientMailbox</span></span><a class="headerlink" href="#mailbox_manager.ClientMailbox" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#mailbox_manager.EmailReader" title="mailbox_manager.EmailReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">EmailReader</span></code></a>, <a class="reference internal" href="#mailbox_manager.MailSender" title="mailbox_manager.MailSender"><code class="xref py py-class docutils literal notranslate"><span class="pre">MailSender</span></code></a></p>
<p>Dean’s office mailbox manager.
Enables authorization and uses the Gmail API.</p>
<dl class="simple">
<dt>Attributes:</dt><dd><p>sender (str): The dean’s office mailbox address.
recipient(str): Student’s mailbox address
message(MIMEMultipart):  object that represents an email
credentials (str): authorization data to gmail account
subject(str): subject of an email
body(str): main content of the email
gmail_api_manager (object): A Resource object for interacting with the Gmail API service.
path_to_dir(str): path to a directory to save emails read from the mailbox</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mailbox_manager.ClientMailbox.authorize">
<span class="sig-name descname"><span class="pre">authorize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">client_secrets_file</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox_manager.ClientMailbox.authorize" title="Link to this definition">¶</a></dt>
<dd><p>Authorizes access to Gmail using the OAuth2 method and sets the gmail_api_manager value.</p>
<p>:param client_secrets_file:file with credentials to Gmail API
:return: A Resource object for interacting with the Gmail API.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mailbox_manager.ClientMailbox.clean_dir_with_mails">
<span class="sig-name descname"><span class="pre">clean_dir_with_mails</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mailbox_manager.ClientMailbox.clean_dir_with_mails" title="Link to this definition">¶</a></dt>
<dd><p>Cleans the directory containing saved emails by deleting all files and subdirectories.</p>
<p>This method removes all files and symbolic links inside the directory specified by
<cite>self.path_to_dir</cite>. It also recursively deletes all subdirectories within that directory.
It is called every time the application is being used to delete old mails from the previous mailbox scan.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mailbox_manager.ClientMailbox.generate_ai_response">
<span class="sig-name descname"><span class="pre">generate_ai_response</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mailbox_manager.ClientMailbox.generate_ai_response" title="Link to this definition">¶</a></dt>
<dd><p>Generate AI responses for saved emails using Mistral Gpt model</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mailbox_manager.ClientMailbox.read_message">
<span class="sig-name descname"><span class="pre">read_message</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">service</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">message</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">which_mail</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox_manager.ClientMailbox.read_message" title="Link to this definition">¶</a></dt>
<dd><p>Reads mails and saves them into the project directory</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>service</strong> – Gmail API manager</p></li>
<li><p><strong>message</strong> – mail</p></li>
<li><p><strong>which_mail</strong> – number of read mail</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mailbox_manager.ClientMailbox.read_unread">
<span class="sig-name descname"><span class="pre">read_unread</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">service</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox_manager.ClientMailbox.read_unread" title="Link to this definition">¶</a></dt>
<dd><p>Searches the mailbox and returns unread messages from students.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>service</strong> – Gmail API manager</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>False if no unread emails from students else calls read_message() method</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>boolean</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mailbox_manager.ClientMailbox.save_attachment">
<span class="sig-name descname"><span class="pre">save_attachment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_b64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">original_filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir_with_mails</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox_manager.ClientMailbox.save_attachment" title="Link to this definition">¶</a></dt>
<dd><p>Save email attachment to local file after checking attachment extension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_b64</strong> – base64 encoded attachment data</p></li>
<li><p><strong>original_filename</strong> – original filename of the attachment</p></li>
<li><p><strong>dir_with_mails</strong> – directory path to save attachments</p></li>
<li><p><strong>i</strong> – attachment index for unique naming</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mailbox_manager.ClientMailbox.send_message">
<span class="sig-name descname"><span class="pre">send_message</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">service</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path_to_mail</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox_manager.ClientMailbox.send_message" title="Link to this definition">¶</a></dt>
<dd><p>sends answer mail to a student</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>service</strong> – Gmail API manager</p></li>
<li><p><strong>path_to_mail</strong> – path to directory with mail</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mailbox_manager.EmailReader">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mailbox_manager.</span></span><span class="sig-name descname"><span class="pre">EmailReader</span></span><a class="headerlink" href="#mailbox_manager.EmailReader" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Abstract base class for reading emails.</p>
<dl class="py method">
<dt class="sig sig-object py" id="mailbox_manager.EmailReader.read_message">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">read_message</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">service</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">message</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">which_mail</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox_manager.EmailReader.read_message" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mailbox_manager.EmailReader.read_unread">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">read_unread</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">service</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox_manager.EmailReader.read_unread" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mailbox_manager.MailSender">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mailbox_manager.</span></span><span class="sig-name descname"><span class="pre">MailSender</span></span><a class="headerlink" href="#mailbox_manager.MailSender" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Abstract base class for generating and sending emails.</p>
<dl class="py method">
<dt class="sig sig-object py" id="mailbox_manager.MailSender.add_attachments">
<span class="sig-name descname"><span class="pre">add_attachments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path_to_dir_with_attachments</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classification_result</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox_manager.MailSender.add_attachments" title="Link to this definition">¶</a></dt>
<dd><p>Add attachments from a directory to the email message.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path_to_dir_with_attachments</strong> – base directory with attachment folders</p></li>
<li><p><strong>classification_result</strong> – classification category (folder name)</p></li>
<li><p><strong>msg</strong> – EmailMessage object to add attachments to</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mailbox_manager.MailSender.generate_ai_response">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">generate_ai_response</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mailbox_manager.MailSender.generate_ai_response" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mailbox_manager.MailSender.generate_simple_response">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">generate_simple_response</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">category</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">response_file</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox_manager.MailSender.generate_simple_response" title="Link to this definition">¶</a></dt>
<dd><p>Generate a simple canned response based on classification category and write it to file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>category</strong> – classification category of the email</p></li>
<li><p><strong>path</strong> – directory path where response file will be saved</p></li>
<li><p><strong>response_file</strong> – full path to response file</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mailbox_manager.MailSender.send_message">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">send_message</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">service</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path_to_mail</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox_manager.MailSender.send_message" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mailbox_manager.decode_base64">
<span class="sig-prename descclassname"><span class="pre">mailbox_manager.</span></span><span class="sig-name descname"><span class="pre">decode_base64</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox_manager.decode_base64" title="Link to this definition">¶</a></dt>
<dd><p>Decode base64 string with padding correction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> – base64 encoded string</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>decoded utf-8 string</p>
</dd>
</dl>
</dd></dl>

<dl class="py class" id="module-response_generation">
<dt class="sig sig-object py" id="response_generation.GptManager">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">response_generation.</span></span><span class="sig-name descname"><span class="pre">GptManager</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_session</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#response_generation.GptManager" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Manager class for generating responses to student emails using the Mistral AI API.</p>
<section id="attributes">
<h2>Attributes<a class="headerlink" href="#attributes" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>database<span class="classifier">Session</span></dt><dd><p>Database session used to query additional information such as office hours or scholarship details.</p>
</dd>
<dt>headers<span class="classifier">dict</span></dt><dd><p>HTTP headers including authorization and content-type for API requests.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="response_generation.GptManager.generate_one_response">
<span class="sig-name descname"><span class="pre">generate_one_response</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mail_category</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mail_content</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir_to_write</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#response_generation.GptManager.generate_one_response" title="Link to this definition">¶</a></dt>
<dd><p>Generates a response based on the email category and content, then writes it to a file.
Sends a POST request to the Mistral AI API with a prompt tailored to the email category.
If the request fails, it falls back to a simple response generator from MailSender.</p>
<section id="parameters">
<h3>Parameters<a class="headerlink" href="#parameters" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>mail_category<span class="classifier">str</span></dt><dd><p>Category of the email (e.g. ‘student_id_extension’, ‘grade_change_from_other_university’, ‘office_hours’, ‘scholarship’).</p>
</dd>
<dt>mail_content<span class="classifier">str</span></dt><dd><p>Content of the student’s email used as input for response generation.</p>
</dd>
<dt>dir_to_write<span class="classifier">str</span></dt><dd><p>Directory path where the generated response file will be saved.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="response_generation.GptManager.generate_responses">
<span class="sig-name descname"><span class="pre">generate_responses</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#response_generation.GptManager.generate_responses" title="Link to this definition">¶</a></dt>
<dd><p>Processes all emails in the ‘EmailsToRespond’ folder by reading classification results
and plain text content, then generates and writes responses for each email.</p>
<section id="behavior">
<h3>Behavior<a class="headerlink" href="#behavior" title="Link to this heading">¶</a></h3>
<p>Walks through the ‘EmailsToRespond’ directory recursively.
For each email folder containing both ‘classification_result.txt’ and ‘plain_text.txt’,
reads their content, calls generate_one_response to create a response,
and clears mail_topic and mail_content to process the next email.</p>
</section>
</dd></dl>

</section>
</dd></dl>

</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="#">MailResponder</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="#">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, Bartlomiej Kalinowski.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="_sources/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>